/* ===============================
   GameComponent.css
   =============================== */

:root{
  --active-top: 158px;
  --popup-offset: 150px;
  --scale: 0.88;
  --card-w: 310px;
  --card-min-h: 110px;
}

html, body { overscroll-behavior: none; }

/* Score flash */
@keyframes scoreFlash { 0%{background:transparent;color:#fff;}25%{background:rgba(255,221,0,.9);color:#000;}60%{background:rgba(255,221,0,.75);color:#000;}100%{background:transparent;color:#fff;} }
.score-flash{animation:scoreFlash .6s ease-out 1;border-radius:4px;padding:0 4px}

/* Header — bigger logo/title */
.title-row{display:flex;align-items:center;justify-content:center;gap:.7em;margin-bottom:.25rem}
.game-logo{height:2.4em;width:auto;display:block}
.game-title{margin:0;font-weight:800;line-height:1;font-size:clamp(2.05rem,6vw,3.6rem)}
.game-header{position:relative;z-index:1200;text-align:center;margin:12px 0;color:#fff}
.date-line{color:#fff;font-size:1rem;margin-top:4px}
.score-line{color:#fff;font-size:clamp(1.45rem,5.4vw,2.35rem);font-weight:900;margin-top:2px}
.score-number{display:inline-block;min-width:2ch;text-align:right}
.rules-button{margin-top:8px}

/* App shell */
.app-container{max-width:820px;margin:0 auto;padding:16px 8px 32px;overflow-x:hidden;min-height:var(--app-height,100svh);transform-origin:top center}
.app-container.app-fixed{position:fixed;inset:0;height:var(--app-height,100svh);overflow:hidden;background:transparent}
@media (max-width:430px){:root{--scale:.82;--card-w:300px}}
@media (max-width:380px){:root{--scale:.80;--card-w:280px}}

/* Dim backdrop during active level */
.level-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.68);backdrop-filter:blur(3px);z-index:1005;pointer-events:none}

/* Cards */
.path-block{position:relative;border:2px solid;border-radius:14px;padding:10px;margin-bottom:12px;box-shadow:0 1px 1px rgba(0,0,0,.06);width:min(86vw,var(--card-w));margin-left:auto;margin-right:auto;text-align:center;transition:background-color .25s,border-color .25s;background:#f7f7f7}
.path-block-default{border-color:#cfcfcf}
.path-block-correct{background-color:#e6ffe6;border-color:#28a745}
.path-block-incorrect{background-color:#ffe6e6;border-color:#dc3545}
.path-block-incorrect img{filter:grayscale(100%) brightness(85%)}

/* Active card */
.level-card--active{position:fixed;left:50%;top:var(--active-top);transform:translateX(-50%);width:min(92vw,calc(var(--card-w) + 24px));max-height:min(420px,calc(var(--app-height,100svh) - var(--active-top) - 80px));min-height:220px;overflow-y:auto;z-index:1105;border:2px solid #e5e7eb;border-radius:18px;padding:14px;box-shadow:0 22px 60px rgba(0,0,0,.42);animation:card-enter 360ms cubic-bezier(.2,.8,.2,1) 10ms both;text-align:center}

/* Covered cards */
.level-card.is-covered{position:static;width:min(86vw,var(--card-w));min-height:var(--card-min-h);max-height:var(--card-min-h);overflow:hidden;background:#1b2838!important;border-color:#25354a!important}
.level-card.is-covered .card-body,.level-card.is-covered .helmet-sequence,.level-card.is-covered .guess-input-container{opacity:0;visibility:hidden;height:0}
.level-card.is-covered .level-badge{display:none}

/* Game-complete: short cards & matching widths */
.is-complete .level-card{width:min(92vw,calc(var(--card-w) + 36px));min-height:44px;padding:8px}
.is-complete .card-body{margin-top:26px}
.is-complete .level-tag{font-size:.78rem;padding:4px 8px}
.is-complete .level-badge{right:8px;left:auto}

/* Overlays/badges */
.level-cover{position:absolute;inset:0;display:grid;place-items:center;background:transparent;color:#fff;font-weight:700;opacity:0;pointer-events:none;transition:opacity 180ms ease;z-index:2}
.level-card.is-covered .level-cover{opacity:1}
.level-cover-label{font-size:clamp(.95rem,3vw,1.1rem);border:2px solid rgba(255,255,255,.75);padding:6px 10px;border-radius:8px;backdrop-filter:blur(2px)}
.level-tag{position:absolute;top:8px;left:8px;padding:6px 10px;border-radius:10px;background:rgba(0,0,0,.68);color:#fff;font-weight:800;font-size:.9rem;line-height:1;z-index:6}
.level-badge{position:absolute;top:8px;left:8px;z-index:5;background:rgba(0,0,0,.68);color:#fff;font-weight:700;font-size:.9rem;padding:6px 10px;border-radius:10px;line-height:1}
.level-badge.won{background:#28a745}
.level-badge.zero{background:#6b7280}
.level-card--active .level-badge{left:auto;right:8px}

/* Content spacing */
.card-body{margin-top:42px}
.click-hint{font-size:.8rem;color:#6b7280;margin:-2px 0 6px}

/* Helmets + arrows (normal) */
.helmet-sequence{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;gap:6px;margin:0 0 8px 0;text-align:center}
.helmet-icon{width:68px;height:68px;object-fit:contain}
@media (max-width:480px){.helmet-icon{width:56px;height:56px}}
@media (max-width:480px){
  .level-card--active .helmet-icon{width:64px;height:64px}
  .level-card--active .arrow{font-size:.85rem}
}
.arrow{font-size:.85rem;font-weight:700;margin:0 2px;line-height:1;vertical-align:middle}
@media (max-width:480px){.arrow{font-size:.75rem}}

/* Helmet appear animation */
@keyframes spin-fade-in{0%{opacity:0;transform:rotate(-210deg) scale(.86)}100%{opacity:1;transform:rotate(0) scale(1)}}
.level-card--active .helmet-sequence img{opacity:0;animation:spin-fade-in 640ms cubic-bezier(.2,.8,.2,1) calc(var(--i,0ms) + 140ms) both}
@keyframes arrow-fade-in{from{opacity:0;transform:translateY(2px)}to{opacity:1;transform:translateY(0)}}
.level-card--active .helmet-sequence .arrow{opacity:0;animation:arrow-fade-in 420ms ease-out calc(var(--i,0ms) + 220ms) both}

/* Card enter */
@keyframes card-enter{from{opacity:0;transform:translateX(-50%) translateY(-6px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}

/* Suggestions + input */
.suggestion-box{max-height:150px;overflow-y:auto;border:1px solid #ccc;border-radius:6px;margin:6px auto 0;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.1);width:min(92%,calc(var(--card-w) - 10px));text-align:left}
.suggestion-item{padding:8px 10px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:10px}
.suggestion-item:hover,.suggestion-item.highlighted{background:#f0f0f0}
.suggest-name{min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.suggest-pos{color:#8a8f98;font-size:.85em;margin-left:8px}
.fade-in-fast{animation:fadeIn .3s ease-out}
@keyframes fadeIn{to{opacity:1}}

.guess-input-container{display:flex;justify-content:center;margin-top:6px}
.guess-input-field{width:98%;max-width:300px;padding:4px 6px;font-size:16px;border-radius:8px;border:1px solid #ccc;-webkit-text-size-adjust:100%;margin-left:auto;margin-right:auto}

/* Points bar */
.points-wrap{width:100%;margin-top:10px;display:flex;flex-direction:column;align-items:center}
.points-row{display:flex;justify-content:space-between;width:min(92%,320px);font-size:12px;color:#111}
.points-label,.points-value{font-weight:700}
.points-bar{width:min(92%,320px);height:10px;background:#e7efff;border-radius:999px;overflow:hidden;border:1px solid #c9d6ff;margin-top:4px}
.points-bar-fill{height:100%;width:var(--fill,100%);background:#2e6bff;transition:width 1s linear}

/* Community % bar (game complete) */
.community-wrap{width:100%;margin-top:8px;display:flex;flex-direction:column;align-items:center}
.community-row{display:flex;justify-content:space-between;width:min(92%,360px);font-size:12px;color:#111}
.community-bar{width:min(92%,360px);height:10px;background:#eef2ff;border-radius:999px;overflow:hidden;border:1px solid #c7cffd;margin-top:4px}
.community-bar-fill{height:100%;background:#6366f1;transform-origin:left;transform:scaleX(0);transition:transform .9s ease}
.is-complete .community-bar-fill{transform:scaleX(calc(var(--pct, 0)/100))}

/* Buttons */
.primary-button,.share-score-button{background:#2e6bff;color:#fff;padding:10px 18px;border:none;border-radius:10px;font-size:1rem;font-weight:700;cursor:pointer}
.primary-button:hover,.share-score-button:hover{filter:brightness(1.06)}
.secondary-button{background:#fff;color:#111;padding:8px 14px;border:1.5px solid #cfcfcf;border-radius:10px;font-size:.9rem;font-weight:700;cursor:pointer}
.secondary-button.small{font-size:.88rem;padding:7px 12px}
.skip-button{margin-top:18px}

/* Locked answers */
.locked-answer{padding:6px 10px;border-radius:8px;font-weight:bold;color:#fff;font-size:.85rem;text-align:center}
.answer-correct{background:#28a745;animation:fadeIn .25s ease-in-out}
.answer-incorrect{background:#dc3545}
@keyframes blinkRed{0%{background-color:#dc3545}50%{background-color:#ff6b6b}100%{background-color:#dc3545}}
.blink-red{animation:blinkRed .6s ease-in-out 1}

/* FABs */
.fab-button{position:fixed;padding:6px 10px;font-size:.8rem;z-index:1201}
.fab-history{top:12px;right:12px}

/* History popup */
.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;margin-bottom:1rem}
.calendar-grid-button{padding:6px;font-size:.75rem;border:1.5px solid #ccc;border-radius:6px;background:#f2f2f2}
.calendar-grid-button.today{background:#e0ecff;border-color:#2e6bff}

/* Completed banner — width matches cards */
.complete-banner{text-align:center;padding:12px;margin:10px auto 14px;background:#d1e7dd;color:#0f5132;border:1px solid #badbcc;border-radius:10px;width:min(92vw,calc(var(--card-w) + 36px))}
.complete-banner h3{margin:0}
.complete-banner p{margin:6px 0 10px;font-size:.95rem}
.complete-actions{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}

/* Popups */
.popup-modal{position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.65);display:flex;align-items:flex-start;justify-content:center;padding-top:var(--popup-offset);z-index:1300}
.popup-content{background:#fff;padding:2rem;border-radius:12px;text-align:center;max-width:520px;width:calc(100% - 32px);max-height:calc(var(--app-height,100svh) - var(--popup-offset) - 16px);overflow:auto;box-shadow:0 8px 20px rgba(0,0,0,.25);position:relative}
.popup-rules{max-width:600px;min-height:520px}
.popup-final{max-width:300px;font-size:1.08rem;padding:1.25rem 1rem;min-height:280px}
.popup-title{font-size:1.55rem;margin-bottom:6px}
.popup-date{margin:6px 0 14px;font-weight:700;color:#333}
.popup-score{margin:12px 0 10px;font-weight:900;font-size:clamp(1.6rem,6.2vw,2.7rem)}
.popup-final .score-number{display:inline-block;min-width:3ch}
.close-button{position:absolute;top:12px;right:12px;background:transparent;font-size:18px;border:none;cursor:pointer}

/* Feedback popup bits */
.email-row{display:flex;align-items:center;justify-content:center;margin-top:1em;gap:8px}
.email-emoji{font-size:1.2rem}
.email-text{font-size:.95rem}
.copied-msg{margin-top:.5em;color:green;font-size:.8rem}

/* Rules lists */
.rules-list{list-style:none;padding-left:0;margin-top:8px;text-align:left}
.rules-list.football-bullets li{position:relative;padding-left:1.6rem;margin:6px 0}
.rules-list.football-bullets li::before{content:"🏈";position:absolute;left:0;top:0;transform:translateY(2px);font-size:1rem}
.rules-main li{font-weight:800;font-size:1.15rem}
.rules-main{margin-bottom:10px}
.fine-print-title{margin:12px 0 4px;font-size:1rem;font-weight:400}
.rules-fineprint li{font-weight:400;font-size:.9rem;opacity:.95}

/* Possible answers */
.possible-answers{margin-top:6px;padding:6px;background:#eee;border-radius:6px}
.possible-answers-list{list-style:none;padding-left:0;margin-top:4px;font-size:.9rem}
.possible-answers-list li{display:flex;align-items:center;justify-content:space-between;gap:8px}
.answer-pos{color:#8a8f98;font-size:.9em}

/* Footer */
.footer-actions{display:flex;justify-content:center;margin:10px auto 6px}
.feedback-bottom{margin-bottom:4px}
.site-disclosure{margin:18px auto 10px;max-width:800px;text-align:center;font-size:10px;line-height:1.25;color:#9aa3af;padding:0 10px}

/* Reduce motion */
@media (prefers-reduced-motion:reduce){
  .level-card,.level-card--active,.level-card--active .helmet-sequence img,.level-card--active .helmet-sequence .arrow{animation:none!important;transition:none!important}
}
/* --- HINT theme & bar marker --- */
:root {
  --hint-color: #F59E0B; /* amber */
}

/* Make the points bar a touch bigger */
.points-bar {
  position: relative;       /* for the marker */
  height: 12px;             /* bigger than before */
  border-radius: 999px;
}
.points-bar-fill {
  height: 100%;             /* match parent height */
  border-radius: inherit;
}

/* 50-point marker that sits centered in the bar */
.points-bar-marker {
  position: absolute;
  left: 50%;
  top: -1px;
  bottom: -1px;
  width: 2px;
  background: var(--hint-color);
  opacity: 0.85;
  border-radius: 1px;
  pointer-events: none;
}

/* Hint UI */
.hint-row { margin-top: 8px; }
.hint-button {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  font-weight: 600;
  padding: 6px 10px;
  border-radius: 10px;
  background: transparent;
  border: 1px solid var(--hint-color);
  color: var(--hint-color);
}
.hint-button:hover { background: rgba(245, 158, 11, 0.08); }

.hint-chip {
  display: inline-block;
  font-size: 0.86rem;
  font-weight: 700;
  padding: 4px 8px;
  border-radius: 8px;
  background: #FFF7ED;        /* amber-50-ish */
  color: #92400E;             /* amber-900-ish */
  border: 1px solid #FED7AA;  /* amber-200-ish */
}

/* Suggestions: name on the left (with highlight), position right-aligned gray */
.suggestion-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  cursor: pointer;
}
.suggestion-item.highlighted { background: #F3F4F6; } /* gray-100 */
.suggestion-name {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.suggestion-pos {
  margin-left: auto;
  color: #9CA3AF; /* gray-400 */
  font-weight: 600;
  font-size: 12px;
}

/* End-game answer positions */
.possible-answers-list .answer-pos {
  color: #9CA3AF; /* gray-400 */
  margin-left: 6px;
  font-weight: 600;
}
/* ====== Tweaks (drop-in overrides) ====== */

/* Nudge active card down slightly; bring popups closer to top */
:root {
  --active-top: 144px;   /* was 136px */
  --popup-offset: 96px;  /* was ~150px */
}

/* Make the active card a touch shorter */
.level-card--active{
  /* slightly smaller padding and heights */
  padding: 12px;
  min-height: 244px; /* was ~260px */
  max-height: min(392px, calc(var(--app-height, 100svh) - var(--active-top) - 96px)); /* was ~420px */
}

/* Make Give Up just a touch smaller */
.skip-button{
  margin-top: 14px;
  padding: 8px 12px;     /* smaller than primary default */
  font-size: 0.92rem;    /* down a notch */
}

/* Rules popup: smaller, higher, and keep a bit of side margin */
.popup-content{
  width: calc(100% - 40px); /* prevent touching screen edges on tiny devices */
}
.popup-rules{
  max-width: 520px;    /* down from ~600px */
  min-height: 460px;   /* down from ~520px */
}

/* Mobile fit: zoom everything out a bit more */
@media (max-width: 430px){
  :root{ --scale: .82; }   /* was .86 */
}
@media (max-width: 380px){
  :root{ --scale: .80; }   /* was .84 */
}
/* =========================================================
   MOBILE SCALING (safe for position:fixed elements)
   - Scales: active level card, end-game cards, popup white card
   - Leaves header & backdrop logic untouched
   ========================================================= */

/* Tuning knobs */
:root{
  --m-active-scale: .80;      /* active level card on phones */
  --m-complete-scale: .94;    /* end-game cards on phones (slight) */
  --m-popup-scale: .86;       /* rules/final popup content on phones */
  --m-banner-scale: .92;      /* complete banner on phones */
}

/* Prevent iOS focus-zoom while still readable */
.guess-input-field { font-size: 16px !important; }
input, select, textarea { font-size: 16px; }

/* Slightly tighter spacing between end-game cards */
.is-complete .path-block { margin-bottom: 8px; }

/* Phone breakpoint */
@media (max-width: 430px){

  /* 1) Active card: compose its existing translate with a scale.
        Don't scale any ancestor; scale THIS fixed card only. */
  .level-card--active{
    transform: translateX(-50%) scale(var(--m-active-scale)) !important;
    transform-origin: top center;
    /* keep it a bit shorter on phones */
    min-height: 232px;
    max-height: min(360px, calc(var(--app-height, 100svh) - var(--active-top) - 96px));
    padding: 10px 12px;
  }

  /* 2) End-game level cards: small visual shrink */
  .is-complete .level-card{
    transform: scale(var(--m-complete-scale));
    transform-origin: top center;
  }

  /* 3) Completed banner: match overall shrink */
  .complete-banner{
    transform: scale(var(--m-banner-scale));
    transform-origin: top center;
  }

  /* 4) Popups: scale ONLY the white card (keeps overlay full-screen) */
  .popup-content{
    transform: scale(var(--m-popup-scale));
    transform-origin: top center;
    width: calc(100% - 36px);  /* keep nice side gutters */
    max-width: 460px;
    padding: 1.05rem .95rem;   /* slightly tighter padding when scaled */
  }

  /* Optional: small harmonizers so contents feel balanced when scaled */
  .helmet-icon { width: 52px; height: 52px; }
  .points-row { width:min(92%, 280px); font-size: 11px; }
  .points-bar { width:min(92%, 280px); }
  .primary-button, .share-score-button { padding: 9px 14px; font-size: .95rem; }
  .secondary-button { padding: 7px 11px; font-size: .86rem; }
  .skip-button { margin-top: 14px; padding: 8px 12px; font-size: .9rem; }
}

/* Very small phones */
@media (max-width: 380px){
  :root{
    --m-active-scale: .76;
    --m-complete-scale: .92;
    --m-popup-scale: .82;
    --m-banner-scale: .90;
  }
  .helmet-icon { width: 48px; height: 48px; }
  .points-row { width:min(92%, 250px); font-size: 10.5px; }
  .points-bar { width:min(92%, 250px); }
  .primary-button, .share-score-button { padding: 8px 12px; font-size: .9rem; }
  .secondary-button { padding: 6px 10px; font-size: .82rem; }
  .skip-button { margin-top: 12px; padding: 7px 11px; font-size: .86rem; }
}
/* =========================================================
   MOBILE SCALING REFINEMENT
   - Keep active-card scale during enter/feedback
   - Gentler scaling (about half the previous shrink)
   - End-game cards slightly scaled
   ========================================================= */

/* Gentler scale defaults */
:root{
  --m-active-scale: .89;     /* was ~.78/.80 → less shrink */
  --m-complete-scale: .97;   /* was ~.92/.94 → less shrink */
}

/* Active card keeps scale even while its 'enter' animation runs
   and during the immediate feedback phase (it keeps the same class) */
@media (max-width: 430px){
  .level-card--active{
    transform: translateX(-50%) scale(var(--m-active-scale)) !important;
    transform-origin: top center;
    /* feed scale into the animation keyframes (see override below) */
    --enter-scale: var(--m-active-scale);
  }

  /* End-game: slightly scaled down */
  .is-complete .level-card{
    transform: scale(var(--m-complete-scale)) !important;
    transform-origin: top center;
  }
}

/* Smaller phones: a touch more shrink than above, but still gentler than before */
@media (max-width: 380px){
  :root{
    --m-active-scale: .86;
    --m-complete-scale: .95;
  }
  .level-card--active{ --enter-scale: var(--m-active-scale); }
}

/* IMPORTANT: Override the active-card enter animation so it preserves scale
   (previous keyframes set transform without scale, which momentarily removed it) */
@keyframes card-enter{
  from{
    opacity: 0;
    transform: translateX(-50%) translateY(-6px) scale(var(--enter-scale, 1));
  }
  to{
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(var(--enter-scale, 1));
  }
}
/* =========================================================
   SUBTLER ACTIVE SCALE + SLIGHTLY LARGER HELMETS (MOBILE)
   (append at end of GameComponent.css)
   ========================================================= */

/* Gentler active scaling */
:root{
  --m-active-scale: .94;   /* was ~.89/.90 — less shrink */
}

/* Ensure the animation keeps the new scale during pop-in/reveal */
@keyframes card-enter{
  from{
    opacity: 0;
    transform: translateX(-50%) translateY(-6px) scale(var(--enter-scale, 1));
  }
  to{
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(var(--enter-scale, 1));
  }
}

/* Phones */
@media (max-width: 430px){
  /* Active card: compose translate + the gentler scale, and feed
     the scale into the enter animation so it never 'snaps' back */
  .level-card--active{
    --enter-scale: var(--m-active-scale);
    transform: translateX(-50%) scale(var(--m-active-scale)) !important;
    transform-origin: top center;
  }

  /* Helmets a bit larger overall and in the active card */
  .helmet-icon{ width: 58px; height: 58px; }                 /* was ~52–56 */
  .level-card--active .helmet-icon{ width: 66px; height: 66px; } /* was ~64 */
}

/* Smaller phones */
@media (max-width: 380px){
  :root{ --m-active-scale: .92; }  /* a touch more than before */

  .level-card--active{ --enter-scale: var(--m-active-scale); }

  .helmet-icon{ width: 54px; height: 54px; }                 /* up from ~48–52 */
  .level-card--active .helmet-icon{ width: 62px; height: 62px; } /* up from ~60–64 */
}
